#!/bin/bash

echo "ğŸ”§ SonarQube - ConfiguraÃ§Ã£o Inicial"
echo "================================="
echo ""

echo "ğŸ“‹ Passos para configurar SonarQube:"
echo ""

echo "ğŸŒ OPÃ‡ÃƒO 1: SonarCloud (Recomendado - Gratuito)"
echo "----------------------------------------------"
echo "1. Acesse: https://sonarcloud.io"
echo "2. FaÃ§a login com sua conta GitHub"
echo "3. Importe este repositÃ³rio"
echo "4. Copie o token gerado"
echo "5. Configure os secrets no GitHub:"
echo "   - SONAR_TOKEN: <seu-token>"
echo "6. Execute: git push (para triggerar o workflow)"
echo ""

echo "ğŸ³ OPÃ‡ÃƒO 2: SonarQube Local"
echo "---------------------------"
echo "1. Execute: ./scripts/run-sonar-analysis.sh"
echo "2. Aguarde inicializaÃ§Ã£o (pode demorar)"
echo "3. Acesse: http://localhost:9000"
echo "4. Login: admin / admin"
echo "5. Configure seu projeto"
echo ""

echo "ğŸ“¦ OPÃ‡ÃƒO 3: InstalaÃ§Ã£o Global do SonarScanner"
echo "--------------------------------------------"
echo "# Ubuntu/Debian:"
echo "curl -sSLo sonar-scanner.zip https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.8.0.2856-linux.zip"
echo "unzip sonar-scanner.zip"
echo "sudo mv sonar-scanner-4.8.0.2856-linux /opt/sonar-scanner"
echo "sudo ln -s /opt/sonar-scanner/bin/sonar-scanner /usr/local/bin/"
echo ""

echo "# macOS:"
echo "brew install sonar-scanner"
echo ""

echo "ğŸ”§ Scripts DisponÃ­veis:"
echo "----------------------"
echo "npm run lint          # Verificar cÃ³digo com ESLint"
echo "npm run lint:fix      # Corrigir problemas automaticamente"
echo "npm run sonar:up      # Subir SonarQube local"
echo "npm run sonar:down    # Parar SonarQube local"
echo "npm run sonar         # AnÃ¡lise (com sonar-scanner instalado)"
echo "npm run sonar:local   # AnÃ¡lise com Docker"
echo "npm run quality:check # Lint + AnÃ¡lise SonarQube"
echo ""

echo "ğŸ“Š MÃ©tricas que serÃ£o analisadas:"
echo "--------------------------------"
echo "âœ… Bugs e vulnerabilidades"
echo "âœ… Code smells"
echo "âœ… Complexidade ciclomÃ¡tica"
echo "âœ… DuplicaÃ§Ã£o de cÃ³digo"
echo "âœ… Maintainability rating"
echo "âœ… Security rating"
echo "âœ… Reliability rating"
echo ""

echo "ğŸ¯ Quality Gates configurados:"
echo "-----------------------------"
echo "â€¢ Coverage: > 80% (quando houver testes)"
echo "â€¢ Duplicated Lines: < 3%"
echo "â€¢ Maintainability Rating: A"
echo "â€¢ Reliability Rating: A"
echo "â€¢ Security Rating: A"
echo ""

echo "ğŸš€ Para comeÃ§ar agora:"
echo "---------------------"
echo "1. npm install                    # Instalar dependÃªncias"
echo "2. npm run lint                   # Verificar qualidade local"
echo "3. ./scripts/run-sonar-analysis.sh # AnÃ¡lise completa"
echo ""
